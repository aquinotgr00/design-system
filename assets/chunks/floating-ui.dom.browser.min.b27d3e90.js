function V(t){return t.split("-")[1]}function st(t){return t==="y"?"height":"width"}function H(t){return t.split("-")[0]}function G(t){return["top","bottom"].includes(H(t))?"x":"y"}function mt(t,e,o){let{reference:n,floating:r}=t;const i=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2,c=G(e),f=st(c),a=n[f]/2-r[f]/2,h=c==="x";let s;switch(H(e)){case"top":s={x:i,y:n.y-r.height};break;case"bottom":s={x:i,y:n.y+n.height};break;case"right":s={x:n.x+n.width,y:l};break;case"left":s={x:n.x-r.width,y:l};break;default:s={x:n.x,y:n.y}}switch(V(e)){case"start":s[c]-=a*(o&&h?-1:1);break;case"end":s[c]+=a*(o&&h?-1:1)}return s}const Bt=async(t,e,o)=>{const{placement:n="bottom",strategy:r="absolute",middleware:i=[],platform:l}=o,c=i.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(e));let a=await l.getElementRects({reference:t,floating:e,strategy:r}),{x:h,y:s}=mt(a,n,f),d=n,u={},p=0;for(let m=0;m<c.length;m++){const{name:g,fn:y}=c[m],{x,y:w,data:L,reset:v}=await y({x:h,y:s,initialPlacement:n,placement:d,strategy:r,middlewareData:u,rects:a,platform:l,elements:{reference:t,floating:e}});h=x!=null?x:h,s=w!=null?w:s,u={...u,[g]:{...u[g],...L}},v&&p<=50&&(p++,typeof v=="object"&&(v.placement&&(d=v.placement),v.rects&&(a=v.rects===!0?await l.getElementRects({reference:t,floating:e,strategy:r}):v.rects),{x:h,y:s}=mt(a,d,f)),m=-1)}return{x:h,y:s,placement:d,strategy:r,middlewareData:u}};function N(t,e){return typeof t=="function"?t(e):t}function at(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function _(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function Q(t,e){var o;e===void 0&&(e={});const{x:n,y:r,platform:i,rects:l,elements:c,strategy:f}=t,{boundary:a="clippingAncestors",rootBoundary:h="viewport",elementContext:s="floating",altBoundary:d=!1,padding:u=0}=N(e,t),p=at(u),m=c[d?s==="floating"?"reference":"floating":s],g=_(await i.getClippingRect({element:(o=await(i.isElement==null?void 0:i.isElement(m)))==null||o?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:a,rootBoundary:h,strategy:f})),y=s==="floating"?{...l.floating,x:n,y:r}:l.reference,x=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),w=await(i.isElement==null?void 0:i.isElement(x))&&await(i.getScale==null?void 0:i.getScale(x))||{x:1,y:1},L=_(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:x,strategy:f}):y);return{top:(g.top-L.top+p.top)/w.y,bottom:(L.bottom-g.bottom+p.bottom)/w.y,left:(g.left-L.left+p.left)/w.x,right:(L.right-g.right+p.right)/w.x}}const j=Math.min,tt=Math.max;function lt(t,e,o){return tt(t,j(e,o))}const _t=t=>({name:"arrow",options:t,async fn(e){const{x:o,y:n,placement:r,rects:i,platform:l,elements:c}=e,{element:f,padding:a=0}=N(t,e)||{};if(f==null)return{};const h=at(a),s={x:o,y:n},d=G(r),u=st(d),p=await l.getDimensions(f),m=d==="y",g=m?"top":"left",y=m?"bottom":"right",x=m?"clientHeight":"clientWidth",w=i.reference[u]+i.reference[d]-s[d]-i.floating[u],L=s[d]-i.reference[d],v=await(l.getOffsetParent==null?void 0:l.getOffsetParent(f));let T=v?v[x]:0;T&&await(l.isElement==null?void 0:l.isElement(v))||(T=c.floating[x]||i.floating[u]);const $=w/2-L/2,D=T/2-p[u]/2-1,k=j(h[g],D),E=j(h[y],D),b=k,A=T-p[u]-E,R=T/2-p[u]/2+$,C=lt(b,R,A),F=V(r)!=null&&R!=C&&i.reference[u]/2-(R<b?k:E)-p[u]/2<0;return{[d]:s[d]-(F?R<b?b-R:A-R:0),data:{[d]:C,centerOffset:R-C}}}}),Lt=["top","right","bottom","left"],ht=Lt.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]),Vt={left:"right",right:"left",bottom:"top",top:"bottom"};function et(t){return t.replace(/left|right|bottom|top/g,e=>Vt[e])}function Tt(t,e,o){o===void 0&&(o=!1);const n=V(t),r=G(t),i=st(r);let l=r==="x"?n===(o?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(l=et(l)),{main:l,cross:et(l)}}const Mt={start:"end",end:"start"};function Z(t){return t.replace(/start|end/g,e=>Mt[e])}const jt=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var o,n,r;const{rects:i,middlewareData:l,placement:c,platform:f,elements:a}=e,{crossAxis:h=!1,alignment:s,allowedPlacements:d=ht,autoAlignment:u=!0,...p}=N(t,e),m=s!==void 0||d===ht?function(E,b,A){return(E?[...A.filter(R=>V(R)===E),...A.filter(R=>V(R)!==E)]:A.filter(R=>H(R)===R)).filter(R=>!E||V(R)===E||!!b&&Z(R)!==R)}(s||null,u,d):d,g=await Q(e,p),y=((o=l.autoPlacement)==null?void 0:o.index)||0,x=m[y];if(x==null)return{};const{main:w,cross:L}=Tt(x,i,await(f.isRTL==null?void 0:f.isRTL(a.floating)));if(c!==x)return{reset:{placement:m[0]}};const v=[g[H(x)],g[w],g[L]],T=[...((n=l.autoPlacement)==null?void 0:n.overflows)||[],{placement:x,overflows:v}],$=m[y+1];if($)return{data:{index:y+1,overflows:T},reset:{placement:$}};const D=T.map(E=>{const b=V(E.placement);return[E.placement,b&&h?E.overflows.slice(0,2).reduce((A,R)=>A+R,0):E.overflows[0],E.overflows]}).sort((E,b)=>E[1]-b[1]),k=((r=D.filter(E=>E[2].slice(0,V(E[0])?2:3).every(b=>b<=0))[0])==null?void 0:r[0])||D[0][0];return k!==c?{data:{index:y+1,overflows:T},reset:{placement:k}}:{}}}},qt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var o;const{placement:n,middlewareData:r,rects:i,initialPlacement:l,platform:c,elements:f}=e,{mainAxis:a=!0,crossAxis:h=!0,fallbackPlacements:s,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:p=!0,...m}=N(t,e),g=H(n),y=H(l)===l,x=await(c.isRTL==null?void 0:c.isRTL(f.floating)),w=s||(y||!p?[et(l)]:function(b){const A=et(b);return[Z(b),A,Z(A)]}(l));s||u==="none"||w.push(...function(b,A,R,C){const F=V(b);let O=function(I,rt,Ft){const ut=["left","right"],dt=["right","left"],Ht=["top","bottom"],Wt=["bottom","top"];switch(I){case"top":case"bottom":return Ft?rt?dt:ut:rt?ut:dt;case"left":case"right":return rt?Ht:Wt;default:return[]}}(H(b),R==="start",C);return F&&(O=O.map(I=>I+"-"+F),A&&(O=O.concat(O.map(Z)))),O}(l,p,u,x));const L=[l,...w],v=await Q(e,m),T=[];let $=((o=r.flip)==null?void 0:o.overflows)||[];if(a&&T.push(v[g]),h){const{main:b,cross:A}=Tt(n,i,x);T.push(v[b],v[A])}if($=[...$,{placement:n,overflows:T}],!T.every(b=>b<=0)){var D,k;const b=(((D=r.flip)==null?void 0:D.index)||0)+1,A=L[b];if(A)return{data:{index:b,overflows:$},reset:{placement:A}};let R=(k=$.filter(C=>C.overflows[0]<=0).sort((C,F)=>C.overflows[1]-F.overflows[1])[0])==null?void 0:k.placement;if(!R)switch(d){case"bestFit":{var E;const C=(E=$.map(F=>[F.placement,F.overflows.filter(O=>O>0).reduce((O,I)=>O+I,0)]).sort((F,O)=>F[1]-O[1])[0])==null?void 0:E[0];C&&(R=C);break}case"initialPlacement":R=l}if(n!==R)return{reset:{placement:R}}}return{}}}};function pt(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function gt(t){return Lt.some(e=>t[e]>=0)}const Gt=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:o}=e,{strategy:n="referenceHidden",...r}=N(t,e);switch(n){case"referenceHidden":{const i=pt(await Q(e,{...r,elementContext:"reference"}),o.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:gt(i)}}}case"escaped":{const i=pt(await Q(e,{...r,altBoundary:!0}),o.floating);return{data:{escapedOffsets:i,escaped:gt(i)}}}default:return{}}}}};function yt(t){const e=j(...t.map(n=>n.left)),o=j(...t.map(n=>n.top));return{x:e,y:o,width:tt(...t.map(n=>n.right))-e,height:tt(...t.map(n=>n.bottom))-o}}const It=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){const{placement:o,elements:n,rects:r,platform:i,strategy:l}=e,{padding:c=2,x:f,y:a}=N(t,e),h=Array.from(await(i.getClientRects==null?void 0:i.getClientRects(n.reference))||[]),s=function(m){const g=m.slice().sort((w,L)=>w.y-L.y),y=[];let x=null;for(let w=0;w<g.length;w++){const L=g[w];!x||L.y-x.y>x.height/2?y.push([L]):y[y.length-1].push(L),x=L}return y.map(w=>_(yt(w)))}(h),d=_(yt(h)),u=at(c),p=await i.getElementRects({reference:{getBoundingClientRect:function(){if(s.length===2&&s[0].left>s[1].right&&f!=null&&a!=null)return s.find(m=>f>m.left-u.left&&f<m.right+u.right&&a>m.top-u.top&&a<m.bottom+u.bottom)||d;if(s.length>=2){if(G(o)==="x"){const v=s[0],T=s[s.length-1],$=H(o)==="top",D=v.top,k=T.bottom,E=$?v.left:T.left,b=$?v.right:T.right;return{top:D,bottom:k,left:E,right:b,width:b-E,height:k-D,x:E,y:D}}const m=H(o)==="left",g=tt(...s.map(v=>v.right)),y=j(...s.map(v=>v.left)),x=s.filter(v=>m?v.left===y:v.right===g),w=x[0].top,L=x[x.length-1].bottom;return{top:w,bottom:L,left:y,right:g,width:g-y,height:L-w,x:y,y:w}}return d}},floating:n.floating,strategy:l});return r.reference.x!==p.reference.x||r.reference.y!==p.reference.y||r.reference.width!==p.reference.width||r.reference.height!==p.reference.height?{reset:{rects:p}}:{}}}},Jt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:o,y:n}=e,r=await async function(i,l){const{placement:c,platform:f,elements:a}=i,h=await(f.isRTL==null?void 0:f.isRTL(a.floating)),s=H(c),d=V(c),u=G(c)==="x",p=["left","top"].includes(s)?-1:1,m=h&&u?-1:1,g=N(l,i);let{mainAxis:y,crossAxis:x,alignmentAxis:w}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...g};return d&&typeof w=="number"&&(x=d==="end"?-1*w:w),u?{x:x*m,y:y*p}:{x:y*p,y:x*m}}(e,t);return{x:o+r.x,y:n+r.y,data:r}}}};function zt(t){return t==="x"?"y":"x"}const Kt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:o,y:n,placement:r}=e,{mainAxis:i=!0,crossAxis:l=!1,limiter:c={fn:g=>{let{x:y,y:x}=g;return{x:y,y:x}}},...f}=N(t,e),a={x:o,y:n},h=await Q(e,f),s=G(H(r)),d=zt(s);let u=a[s],p=a[d];if(i){const g=s==="y"?"bottom":"right";u=lt(u+h[s==="y"?"top":"left"],u,u-h[g])}if(l){const g=d==="y"?"bottom":"right";p=lt(p+h[d==="y"?"top":"left"],p,p-h[g])}const m=c.fn({...e,[s]:u,[d]:p});return{...m,data:{x:m.x-o,y:m.y-n}}}}};function S(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function W(t){return S(t).getComputedStyle(t)}function At(t){return t instanceof S(t).Node}function z(t){return At(t)?(t.nodeName||"").toLowerCase():""}function B(t){return t instanceof S(t).HTMLElement}function P(t){return t instanceof S(t).Element}function xt(t){return typeof ShadowRoot>"u"?!1:t instanceof S(t).ShadowRoot||t instanceof ShadowRoot}function U(t){const{overflow:e,overflowX:o,overflowY:n,display:r}=W(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+o)&&!["inline","contents"].includes(r)}function Nt(t){return["table","td","th"].includes(z(t))}function ct(t){const e=ft(),o=W(t);return o.transform!=="none"||o.perspective!=="none"||!e&&!!o.backdropFilter&&o.backdropFilter!=="none"||!e&&!!o.filter&&o.filter!=="none"||["transform","perspective","filter"].some(n=>(o.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(o.contain||"").includes(n))}function ft(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function ot(t){return["html","body","#document"].includes(z(t))}const wt=Math.min,J=Math.max,nt=Math.round;function $t(t){const e=W(t);let o=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=B(t),i=r?t.offsetWidth:o,l=r?t.offsetHeight:n,c=nt(o)!==i||nt(n)!==l;return c&&(o=i,n=l),{width:o,height:n,fallback:c}}function Pt(t){return P(t)?t:t.contextElement}const Dt={x:1,y:1};function Y(t){const e=Pt(t);if(!B(e))return Dt;const o=e.getBoundingClientRect(),{width:n,height:r,fallback:i}=$t(e);let l=(i?nt(o.width):o.width)/n,c=(i?nt(o.height):o.height)/r;return l&&Number.isFinite(l)||(l=1),c&&Number.isFinite(c)||(c=1),{x:l,y:c}}const vt={x:0,y:0};function Ct(t,e,o){var n,r;if(e===void 0&&(e=!0),!ft())return vt;const i=t?S(t):window;return!o||e&&o!==i?vt:{x:((n=i.visualViewport)==null?void 0:n.offsetLeft)||0,y:((r=i.visualViewport)==null?void 0:r.offsetTop)||0}}function X(t,e,o,n){e===void 0&&(e=!1),o===void 0&&(o=!1);const r=t.getBoundingClientRect(),i=Pt(t);let l=Dt;e&&(n?P(n)&&(l=Y(n)):l=Y(t));const c=Ct(i,o,n);let f=(r.left+c.x)/l.x,a=(r.top+c.y)/l.y,h=r.width/l.x,s=r.height/l.y;if(i){const d=S(i),u=n&&P(n)?S(n):n;let p=d.frameElement;for(;p&&n&&u!==d;){const m=Y(p),g=p.getBoundingClientRect(),y=getComputedStyle(p);g.x+=(p.clientLeft+parseFloat(y.paddingLeft))*m.x,g.y+=(p.clientTop+parseFloat(y.paddingTop))*m.y,f*=m.x,a*=m.y,h*=m.x,s*=m.y,f+=g.x,a+=g.y,p=S(p).frameElement}}return _({width:h,height:s,x:f,y:a})}function M(t){return((At(t)?t.ownerDocument:t.document)||window.document).documentElement}function it(t){return P(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ot(t){return X(M(t)).left+it(t).scrollLeft}function q(t){if(z(t)==="html")return t;const e=t.assignedSlot||t.parentNode||xt(t)&&t.host||M(t);return xt(e)?e.host:e}function St(t){const e=q(t);return ot(e)?e.ownerDocument.body:B(e)&&U(e)?e:St(e)}function K(t,e){var o;e===void 0&&(e=[]);const n=St(t),r=n===((o=t.ownerDocument)==null?void 0:o.body),i=S(n);return r?e.concat(i,i.visualViewport||[],U(n)?n:[]):e.concat(n,K(n))}function bt(t,e,o){let n;if(e==="viewport")n=function(r,i){const l=S(r),c=M(r),f=l.visualViewport;let a=c.clientWidth,h=c.clientHeight,s=0,d=0;if(f){a=f.width,h=f.height;const u=ft();(!u||u&&i==="fixed")&&(s=f.offsetLeft,d=f.offsetTop)}return{width:a,height:h,x:s,y:d}}(t,o);else if(e==="document")n=function(r){const i=M(r),l=it(r),c=r.ownerDocument.body,f=J(i.scrollWidth,i.clientWidth,c.scrollWidth,c.clientWidth),a=J(i.scrollHeight,i.clientHeight,c.scrollHeight,c.clientHeight);let h=-l.scrollLeft+Ot(r);const s=-l.scrollTop;return W(c).direction==="rtl"&&(h+=J(i.clientWidth,c.clientWidth)-f),{width:f,height:a,x:h,y:s}}(M(t));else if(P(e))n=function(r,i){const l=X(r,!0,i==="fixed"),c=l.top+r.clientTop,f=l.left+r.clientLeft,a=B(r)?Y(r):{x:1,y:1};return{width:r.clientWidth*a.x,height:r.clientHeight*a.y,x:f*a.x,y:c*a.y}}(e,o);else{const r=Ct(t);n={...e,x:e.x-r.x,y:e.y-r.y}}return _(n)}function kt(t,e){const o=q(t);return!(o===e||!P(o)||ot(o))&&(W(o).position==="fixed"||kt(o,e))}function Rt(t,e){return B(t)&&W(t).position!=="fixed"?e?e(t):t.offsetParent:null}function Et(t,e){const o=S(t);if(!B(t))return o;let n=Rt(t,e);for(;n&&Nt(n)&&W(n).position==="static";)n=Rt(n,e);return n&&(z(n)==="html"||z(n)==="body"&&W(n).position==="static"&&!ct(n))?o:n||function(r){let i=q(r);for(;B(i)&&!ot(i);){if(ct(i))return i;i=q(i)}return null}(t)||o}function Xt(t,e,o){const n=B(e),r=M(e),i=o==="fixed",l=X(t,!0,i,e);let c={scrollLeft:0,scrollTop:0};const f={x:0,y:0};if(n||!n&&!i)if((z(e)!=="body"||U(r))&&(c=it(e)),B(e)){const a=X(e,!0,i,e);f.x=a.x+e.clientLeft,f.y=a.y+e.clientTop}else r&&(f.x=Ot(r));return{x:l.left+c.scrollLeft-f.x,y:l.top+c.scrollTop-f.y,width:l.width,height:l.height}}const Yt={getClippingRect:function(t){let{element:e,boundary:o,rootBoundary:n,strategy:r}=t;const i=o==="clippingAncestors"?function(a,h){const s=h.get(a);if(s)return s;let d=K(a).filter(g=>P(g)&&z(g)!=="body"),u=null;const p=W(a).position==="fixed";let m=p?q(a):a;for(;P(m)&&!ot(m);){const g=W(m),y=ct(m);y||g.position!=="fixed"||(u=null),(p?!y&&!u:!y&&g.position==="static"&&u&&["absolute","fixed"].includes(u.position)||U(m)&&!y&&kt(a,m))?d=d.filter(x=>x!==m):u=g,m=q(m)}return h.set(a,d),d}(e,this._c):[].concat(o),l=[...i,n],c=l[0],f=l.reduce((a,h)=>{const s=bt(e,h,r);return a.top=J(s.top,a.top),a.right=wt(s.right,a.right),a.bottom=wt(s.bottom,a.bottom),a.left=J(s.left,a.left),a},bt(e,c,r));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const r=B(o),i=M(o);if(o===i)return e;let l={scrollLeft:0,scrollTop:0},c={x:1,y:1};const f={x:0,y:0};if((r||!r&&n!=="fixed")&&((z(o)!=="body"||U(i))&&(l=it(o)),B(o))){const a=X(o);c=Y(o),f.x=a.x+o.clientLeft,f.y=a.y+o.clientTop}return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-l.scrollLeft*c.x+f.x,y:e.y*c.y-l.scrollTop*c.y+f.y}},isElement:P,getDimensions:function(t){return $t(t)},getOffsetParent:Et,getDocumentElement:M,getScale:Y,async getElementRects(t){let{reference:e,floating:o,strategy:n}=t;const r=this.getOffsetParent||Et,i=this.getDimensions;return{reference:Xt(e,await r(o),n),floating:{x:0,y:0,...await i(o)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>W(t).direction==="rtl"};function Qt(t,e,o,n){n===void 0&&(n={});const{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:l=!0,animationFrame:c=!1}=n,f=r||i?[...P(t)?K(t):t.contextElement?K(t.contextElement):[],...K(e)]:[];f.forEach(d=>{const u=!P(d)&&d.toString().includes("V");!r||c&&!u||d.addEventListener("scroll",o,{passive:!0}),i&&d.addEventListener("resize",o)});let a,h=null;l&&(h=new ResizeObserver(()=>{o()}),P(t)&&!c&&h.observe(t),P(t)||!t.contextElement||c||h.observe(t.contextElement),h.observe(e));let s=c?X(t):null;return c&&function d(){const u=X(t);!s||u.x===s.x&&u.y===s.y&&u.width===s.width&&u.height===s.height||o(),s=u,a=requestAnimationFrame(d)}(),o(),()=>{var d;f.forEach(u=>{r&&u.removeEventListener("scroll",o),i&&u.removeEventListener("resize",o)}),(d=h)==null||d.disconnect(),h=null,c&&cancelAnimationFrame(a)}}const Ut=(t,e,o)=>{const n=new Map,r={platform:Yt,...o},i={...r.platform,_c:n};return Bt(t,e,{...r,platform:i})};export{qt as A,It as D,Gt as E,Jt as L,Ut as M,Kt as O,jt as b,_t as g,Qt as z};
