import{z as ie,V as se,W as ue,j as ae,X as oe,F as fe,u as le}from"../app.389f7721.js";var ee={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function f(a,s,u){this.fn=a,this.context=s,this.once=u||!1}function v(a,s,u,l,y){if(typeof u!="function")throw new TypeError("The listener must be a function");var w=new f(u,l||a,y),d=t?t+s:s;return a._events[d]?a._events[d].fn?a._events[d]=[a._events[d],w]:a._events[d].push(w):(a._events[d]=w,a._eventsCount++),a}function p(a,s){--a._eventsCount===0?a._events=new i:delete a._events[s]}function h(){this._events=new i,this._eventsCount=0}h.prototype.eventNames=function(){var s=[],u,l;if(this._eventsCount===0)return s;for(l in u=this._events)e.call(u,l)&&s.push(t?l.slice(1):l);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(u)):s},h.prototype.listeners=function(s){var u=t?t+s:s,l=this._events[u];if(!l)return[];if(l.fn)return[l.fn];for(var y=0,w=l.length,d=new Array(w);y<w;y++)d[y]=l[y].fn;return d},h.prototype.listenerCount=function(s){var u=t?t+s:s,l=this._events[u];return l?l.fn?1:l.length:0},h.prototype.emit=function(s,u,l,y,w,d){var E=t?t+s:s;if(!this._events[E])return!1;var o=this._events[E],I=arguments.length,C,m;if(o.fn){switch(o.once&&this.removeListener(s,o.fn,void 0,!0),I){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,u),!0;case 3:return o.fn.call(o.context,u,l),!0;case 4:return o.fn.call(o.context,u,l,y),!0;case 5:return o.fn.call(o.context,u,l,y,w),!0;case 6:return o.fn.call(o.context,u,l,y,w,d),!0}for(m=1,C=new Array(I-1);m<I;m++)C[m-1]=arguments[m];o.fn.apply(o.context,C)}else{var ne=o.length,O;for(m=0;m<ne;m++)switch(o[m].once&&this.removeListener(s,o[m].fn,void 0,!0),I){case 1:o[m].fn.call(o[m].context);break;case 2:o[m].fn.call(o[m].context,u);break;case 3:o[m].fn.call(o[m].context,u,l);break;case 4:o[m].fn.call(o[m].context,u,l,y);break;default:if(!C)for(O=1,C=new Array(I-1);O<I;O++)C[O-1]=arguments[O];o[m].fn.apply(o[m].context,C)}}return!0},h.prototype.on=function(s,u,l){return v(this,s,u,l,!1)},h.prototype.once=function(s,u,l){return v(this,s,u,l,!0)},h.prototype.removeListener=function(s,u,l,y){var w=t?t+s:s;if(!this._events[w])return this;if(!u)return p(this,w),this;var d=this._events[w];if(d.fn)d.fn===u&&(!y||d.once)&&(!l||d.context===l)&&p(this,w);else{for(var E=0,o=[],I=d.length;E<I;E++)(d[E].fn!==u||y&&!d[E].once||l&&d[E].context!==l)&&o.push(d[E]);o.length?this._events[w]=o.length===1?o[0]:o:p(this,w)}return this},h.prototype.removeAllListeners=function(s){var u;return s?(u=t?t+s:s,this._events[u]&&p(this,u)):(this._events=new i,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=t,h.EventEmitter=h,n.exports=h})(ee);const he=ee.exports;class te extends Error{constructor(e){super(e),this.name="TimeoutError"}}class ce extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const B=n=>globalThis.DOMException===void 0?new ce(n):new DOMException(n),j=n=>{const e=n.reason===void 0?B("This operation was aborted."):n.reason;return e instanceof Error?e:B(e)};function de(n,e,t,i){let f;const v=new Promise((p,h)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){p(n);return}if(i={customTimers:{setTimeout,clearTimeout},...i},i.signal){const{signal:a}=i;a.aborted&&h(j(a)),a.addEventListener("abort",()=>{h(j(a))})}f=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{p(t())}catch(u){h(u)}return}const a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,s=t instanceof Error?t:new te(a);typeof n.cancel=="function"&&n.cancel(),h(s)},e),(async()=>{try{p(await n)}catch(a){h(a)}finally{i.customTimers.clearTimeout.call(void 0,f)}})()});return v.clear=()=>{clearTimeout(f),f=void 0},v}function _e(n,e,t){let i=0,f=n.length;for(;f>0;){const v=Math.trunc(f/2);let p=i+v;t(n[p],e)<=0?(i=++p,f-=v+1):f=v}return i}var A=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},T;class ve{constructor(){T.set(this,[])}enqueue(e,t){t={priority:0,...t};const i={priority:t.priority,run:e};if(this.size&&A(this,T,"f")[this.size-1].priority>=t.priority){A(this,T,"f").push(i);return}const f=_e(A(this,T,"f"),i,(v,p)=>p.priority-v.priority);A(this,T,"f").splice(f,0,i)}dequeue(){const e=A(this,T,"f").shift();return e==null?void 0:e.run}filter(e){return A(this,T,"f").filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return A(this,T,"f").length}}T=new WeakMap;var c=globalThis&&globalThis.__classPrivateFieldSet||function(n,e,t,i,f){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!f:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?f.call(n,t):f?f.value=t:e.set(n,t),t},r=globalThis&&globalThis.__classPrivateFieldGet||function(n,e,t,i){if(t==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?i:t==="a"?i.call(n):i?i.value:e.get(n)},_,S,W,x,G,z,k,b,N,P,q,g,F,Q,L,X,H,re,J,K,U,$,V,Y,R,D;const me=new te;class pe extends Error{}class we extends he{constructor(e){var t,i,f,v;if(super(),_.add(this),S.set(this,void 0),W.set(this,void 0),x.set(this,0),G.set(this,void 0),z.set(this,void 0),k.set(this,0),b.set(this,void 0),N.set(this,void 0),P.set(this,void 0),q.set(this,void 0),g.set(this,0),F.set(this,void 0),Q.set(this,void 0),L.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:ve,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(v=(f=e.interval)===null||f===void 0?void 0:f.toString())!==null&&v!==void 0?v:""}\` (${typeof e.interval})`);c(this,S,e.carryoverConcurrencyCount,"f"),c(this,W,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),c(this,G,e.intervalCap,"f"),c(this,z,e.interval,"f"),c(this,P,new e.queueClass,"f"),c(this,q,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,c(this,L,e.throwOnTimeout===!0,"f"),c(this,Q,e.autoStart===!1,"f")}get concurrency(){return r(this,F,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);c(this,F,e,"f"),r(this,_,"m",R).call(this)}async add(e,t={}){return new Promise((i,f)=>{const v=async()=>{var p,h,a;c(this,g,(h=r(this,g,"f"),h++,h),"f"),c(this,x,(a=r(this,x,"f"),a++,a),"f");try{if(!((p=t.signal)===null||p===void 0)&&p.aborted){f(new pe("The task was aborted."));return}const u=await(this.timeout===void 0&&t.timeout===void 0?e({signal:t.signal}):de(Promise.resolve(e({signal:t.signal})),t.timeout===void 0?this.timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?r(this,L,"f"):t.throwOnTimeout)&&f(me)}));i(u),this.emit("completed",u)}catch(s){f(s),this.emit("error",s)}r(this,_,"m",re).call(this)};r(this,P,"f").enqueue(v,t),r(this,_,"m",$).call(this),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return r(this,Q,"f")?(c(this,Q,!1,"f"),r(this,_,"m",R).call(this),this):this}pause(){c(this,Q,!0,"f")}clear(){c(this,P,new(r(this,q,"f")),"f")}async onEmpty(){r(this,P,"f").size!==0&&await r(this,_,"m",D).call(this,"empty")}async onSizeLessThan(e){r(this,P,"f").size<e||await r(this,_,"m",D).call(this,"next",()=>r(this,P,"f").size<e)}async onIdle(){r(this,g,"f")===0&&r(this,P,"f").size===0||await r(this,_,"m",D).call(this,"idle")}get size(){return r(this,P,"f").size}sizeBy(e){return r(this,P,"f").filter(e).length}get pending(){return r(this,g,"f")}get isPaused(){return r(this,Q,"f")}}S=new WeakMap,W=new WeakMap,x=new WeakMap,G=new WeakMap,z=new WeakMap,k=new WeakMap,b=new WeakMap,N=new WeakMap,P=new WeakMap,q=new WeakMap,g=new WeakMap,F=new WeakMap,Q=new WeakMap,L=new WeakMap,_=new WeakSet,X=function(){return r(this,W,"f")||r(this,x,"f")<r(this,G,"f")},H=function(){return r(this,g,"f")<r(this,F,"f")},re=function(){var e;c(this,g,(e=r(this,g,"f"),e--,e),"f"),r(this,_,"m",$).call(this),this.emit("next")},J=function(){this.emit("empty"),r(this,g,"f")===0&&this.emit("idle")},K=function(){r(this,_,"m",Y).call(this),r(this,_,"m",V).call(this),c(this,N,void 0,"f")},U=function(){const e=Date.now();if(r(this,b,"f")===void 0){const t=r(this,k,"f")-e;if(t<0)c(this,x,r(this,S,"f")?r(this,g,"f"):0,"f");else return r(this,N,"f")===void 0&&c(this,N,setTimeout(()=>{r(this,_,"m",K).call(this)},t),"f"),!0}return!1},$=function(){if(r(this,P,"f").size===0)return r(this,b,"f")&&clearInterval(r(this,b,"f")),c(this,b,void 0,"f"),r(this,_,"m",J).call(this),!1;if(!r(this,Q,"f")){const e=!r(this,_,"a",U);if(r(this,_,"a",X)&&r(this,_,"a",H)){const t=r(this,P,"f").dequeue();return t?(this.emit("active"),t(),e&&r(this,_,"m",V).call(this),!0):!1}}return!1},V=function(){r(this,W,"f")||r(this,b,"f")!==void 0||(c(this,b,setInterval(()=>{r(this,_,"m",Y).call(this)},r(this,z,"f")),"f"),c(this,k,Date.now()+r(this,z,"f"),"f"))},Y=function(){r(this,x,"f")===0&&r(this,g,"f")===0&&r(this,b,"f")&&(clearInterval(r(this,b,"f")),c(this,b,void 0,"f")),c(this,x,r(this,S,"f")?r(this,g,"f"):0,"f"),r(this,_,"m",R).call(this)},R=function(){for(;r(this,_,"m",$).call(this););},D=async function(e,t){return new Promise(i=>{const f=()=>{t&&!t()||(this.off(e,f),i())};this.on(e,f)})};let M,Z;const ye=new we({concurrency:1});async function Pe(n,e){if(M||(M=ie(new Map)),!Z){const i=document.createElement("div"),f=se({name:"GlobalContainer",render:()=>[...M.value.values()].map(v=>ue(v.component,{ref:v.ref}))});document.body.append(i),f.mount(i),i.id="global",Z=f}let t=M.value.get(n);return t||(t={component:e,ref:ae()},M.value.set(n,t),oe(M),await fe()),le(t.ref)}async function be(n){return await ye.add(()=>Pe(n,n))}export{be as u};
