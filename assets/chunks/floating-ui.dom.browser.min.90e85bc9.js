function B(t){return t.split("-")[1]}function ct(t){return t==="y"?"height":"width"}function O(t){return t.split("-")[0]}function j(t){return["top","bottom"].includes(O(t))?"x":"y"}function dt(t,e,o){let{reference:n,floating:i}=t;const r=n.x+n.width/2-i.width/2,c=n.y+n.height/2-i.height/2,l=j(e),f=ct(l),a=n[f]/2-i[f]/2,h=l==="x";let s;switch(O(e)){case"top":s={x:r,y:n.y-i.height};break;case"bottom":s={x:r,y:n.y+n.height};break;case"right":s={x:n.x+n.width,y:c};break;case"left":s={x:n.x-i.width,y:c};break;default:s={x:n.x,y:n.y}}switch(B(e)){case"start":s[l]-=a*(o&&h?-1:1);break;case"end":s[l]+=a*(o&&h?-1:1)}return s}const Bt=async(t,e,o)=>{const{placement:n="bottom",strategy:i="absolute",middleware:r=[],platform:c}=o,l=r.filter(Boolean),f=await(c.isRTL==null?void 0:c.isRTL(e));let a=await c.getElementRects({reference:t,floating:e,strategy:i}),{x:h,y:s}=dt(a,n,f),d=n,u={},g=0;for(let m=0;m<l.length;m++){const{name:p,fn:y}=l[m],{x,y:v,data:E,reset:b}=await y({x:h,y:s,initialPlacement:n,placement:d,strategy:i,middlewareData:u,rects:a,platform:c,elements:{reference:t,floating:e}});h=x!=null?x:h,s=v!=null?v:s,u={...u,[p]:{...u[p],...E}},b&&g<=50&&(g++,typeof b=="object"&&(b.placement&&(d=b.placement),b.rects&&(a=b.rects===!0?await c.getElementRects({reference:t,floating:e,strategy:i}):b.rects),{x:h,y:s}=dt(a,d,f)),m=-1)}return{x:h,y:s,placement:d,strategy:i,middlewareData:u}};function st(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function Y(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function J(t,e){var o;e===void 0&&(e={});const{x:n,y:i,platform:r,rects:c,elements:l,strategy:f}=t,{boundary:a="clippingAncestors",rootBoundary:h="viewport",elementContext:s="floating",altBoundary:d=!1,padding:u=0}=e,g=st(u),m=l[d?s==="floating"?"reference":"floating":s],p=Y(await r.getClippingRect({element:(o=await(r.isElement==null?void 0:r.isElement(m)))==null||o?m:m.contextElement||await(r.getDocumentElement==null?void 0:r.getDocumentElement(l.floating)),boundary:a,rootBoundary:h,strategy:f})),y=s==="floating"?{...c.floating,x:n,y:i}:c.reference,x=await(r.getOffsetParent==null?void 0:r.getOffsetParent(l.floating)),v=await(r.isElement==null?void 0:r.isElement(x))&&await(r.getScale==null?void 0:r.getScale(x))||{x:1,y:1},E=Y(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:x,strategy:f}):y);return{top:(p.top-E.top+g.top)/v.y,bottom:(E.bottom-p.bottom+g.bottom)/v.y,left:(p.left-E.left+g.left)/v.x,right:(E.right-p.right+g.right)/v.x}}const U=Math.min,Z=Math.max;function rt(t,e,o){return Z(t,U(e,o))}const Yt=t=>({name:"arrow",options:t,async fn(e){const{element:o,padding:n=0}=t||{},{x:i,y:r,placement:c,rects:l,platform:f,elements:a}=e;if(o==null)return{};const h=st(n),s={x:i,y:r},d=j(c),u=ct(d),g=await f.getDimensions(o),m=d==="y",p=m?"top":"left",y=m?"bottom":"right",x=m?"clientHeight":"clientWidth",v=l.reference[u]+l.reference[d]-s[d]-l.floating[u],E=s[d]-l.reference[d],b=await(f.getOffsetParent==null?void 0:f.getOffsetParent(o));let T=b?b[x]:0;T&&await(f.isElement==null?void 0:f.isElement(b))||(T=a.floating[x]||l.floating[u]);const P=v/2-E/2,$=h[p],S=T-g[u]-h[y],w=T/2-g[u]/2+P,R=rt($,w,S),A=B(c)!=null&&w!=R&&l.reference[u]/2-(w<$?h[p]:h[y])-g[u]/2<0;return{[d]:s[d]-(A?w<$?$-w:S-w:0),data:{[d]:R,centerOffset:w-R}}}}),Et=["top","right","bottom","left"],mt=Et.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]),Wt={left:"right",right:"left",bottom:"top",top:"bottom"};function tt(t){return t.replace(/left|right|bottom|top/g,e=>Wt[e])}function Lt(t,e,o){o===void 0&&(o=!1);const n=B(t),i=j(t),r=ct(i);let c=i==="x"?n===(o?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[r]>e.floating[r]&&(c=tt(c)),{main:c,cross:tt(c)}}const Vt={start:"end",end:"start"};function Q(t){return t.replace(/start|end/g,e=>Vt[e])}const _t=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var o,n,i;const{rects:r,middlewareData:c,placement:l,platform:f,elements:a}=e,{crossAxis:h=!1,alignment:s,allowedPlacements:d=mt,autoAlignment:u=!0,...g}=t,m=s!==void 0||d===mt?function(w,R,A){return(w?[...A.filter(L=>B(L)===w),...A.filter(L=>B(L)!==w)]:A.filter(L=>O(L)===L)).filter(L=>!w||B(L)===w||!!R&&Q(L)!==L)}(s||null,u,d):d,p=await J(e,g),y=((o=c.autoPlacement)==null?void 0:o.index)||0,x=m[y];if(x==null)return{};const{main:v,cross:E}=Lt(x,r,await(f.isRTL==null?void 0:f.isRTL(a.floating)));if(l!==x)return{reset:{placement:m[0]}};const b=[p[O(x)],p[v],p[E]],T=[...((n=c.autoPlacement)==null?void 0:n.overflows)||[],{placement:x,overflows:b}],P=m[y+1];if(P)return{data:{index:y+1,overflows:T},reset:{placement:P}};const $=T.map(w=>{const R=B(w.placement);return[w.placement,R&&h?w.overflows.slice(0,2).reduce((A,L)=>A+L,0):w.overflows[0],w.overflows]}).sort((w,R)=>w[1]-R[1]),S=((i=$.filter(w=>w[2].slice(0,B(w[0])?2:3).every(R=>R<=0))[0])==null?void 0:i[0])||$[0][0];return S!==l?{data:{index:y+1,overflows:T},reset:{placement:S}}:{}}}},jt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var o;const{placement:n,middlewareData:i,rects:r,initialPlacement:c,platform:l,elements:f}=e,{mainAxis:a=!0,crossAxis:h=!0,fallbackPlacements:s,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:g=!0,...m}=t,p=O(n),y=O(c)===c,x=await(l.isRTL==null?void 0:l.isRTL(f.floating)),v=s||(y||!g?[tt(c)]:function(R){const A=tt(R);return[Q(R),A,Q(A)]}(c));s||u==="none"||v.push(...function(R,A,L,V){const W=B(R);let k=function(q,it,Ot){const ft=["left","right"],ut=["right","left"],Ht=["top","bottom"],Ft=["bottom","top"];switch(q){case"top":case"bottom":return Ot?it?ut:ft:it?ft:ut;case"left":case"right":return it?Ht:Ft;default:return[]}}(O(R),L==="start",V);return W&&(k=k.map(q=>q+"-"+W),A&&(k=k.concat(k.map(Q)))),k}(c,g,u,x));const E=[c,...v],b=await J(e,m),T=[];let P=((o=i.flip)==null?void 0:o.overflows)||[];if(a&&T.push(b[p]),h){const{main:R,cross:A}=Lt(n,r,x);T.push(b[R],b[A])}if(P=[...P,{placement:n,overflows:T}],!T.every(R=>R<=0)){var $,S;const R=((($=i.flip)==null?void 0:$.index)||0)+1,A=E[R];if(A)return{data:{index:R,overflows:P},reset:{placement:A}};let L=(S=P.filter(V=>V.overflows[0]<=0).sort((V,W)=>V.overflows[1]-W.overflows[1])[0])==null?void 0:S.placement;if(!L)switch(d){case"bestFit":{var w;const V=(w=P.map(W=>[W.placement,W.overflows.filter(k=>k>0).reduce((k,q)=>k+q,0)]).sort((W,k)=>W[1]-k[1])[0])==null?void 0:w[0];V&&(L=V);break}case"initialPlacement":L=c}if(n!==L)return{reset:{placement:L}}}return{}}}};function ht(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function pt(t){return Et.some(e=>t[e]>=0)}const qt=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{strategy:o="referenceHidden",...n}=t,{rects:i}=e;switch(o){case"referenceHidden":{const r=ht(await J(e,{...n,elementContext:"reference"}),i.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:pt(r)}}}case"escaped":{const r=ht(await J(e,{...n,altBoundary:!0}),i.floating);return{data:{escapedOffsets:r,escaped:pt(r)}}}default:return{}}}}};function gt(t){const e=U(...t.map(n=>n.left)),o=U(...t.map(n=>n.top));return{x:e,y:o,width:Z(...t.map(n=>n.right))-e,height:Z(...t.map(n=>n.bottom))-o}}const Gt=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){const{placement:o,elements:n,rects:i,platform:r,strategy:c}=e,{padding:l=2,x:f,y:a}=t,h=Array.from(await(r.getClientRects==null?void 0:r.getClientRects(n.reference))||[]),s=function(m){const p=m.slice().sort((v,E)=>v.y-E.y),y=[];let x=null;for(let v=0;v<p.length;v++){const E=p[v];!x||E.y-x.y>x.height/2?y.push([E]):y[y.length-1].push(E),x=E}return y.map(v=>Y(gt(v)))}(h),d=Y(gt(h)),u=st(l),g=await r.getElementRects({reference:{getBoundingClientRect:function(){if(s.length===2&&s[0].left>s[1].right&&f!=null&&a!=null)return s.find(m=>f>m.left-u.left&&f<m.right+u.right&&a>m.top-u.top&&a<m.bottom+u.bottom)||d;if(s.length>=2){if(j(o)==="x"){const b=s[0],T=s[s.length-1],P=O(o)==="top",$=b.top,S=T.bottom,w=P?b.left:T.left,R=P?b.right:T.right;return{top:$,bottom:S,left:w,right:R,width:R-w,height:S-$,x:w,y:$}}const m=O(o)==="left",p=Z(...s.map(b=>b.right)),y=U(...s.map(b=>b.left)),x=s.filter(b=>m?b.left===y:b.right===p),v=x[0].top,E=x[x.length-1].bottom;return{top:v,bottom:E,left:y,right:p,width:p-y,height:E-v,x:y,y:v}}return d}},floating:n.floating,strategy:c});return i.reference.x!==g.reference.x||i.reference.y!==g.reference.y||i.reference.width!==g.reference.width||i.reference.height!==g.reference.height?{reset:{rects:g}}:{}}}},It=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:o,y:n}=e,i=await async function(r,c){const{placement:l,platform:f,elements:a}=r,h=await(f.isRTL==null?void 0:f.isRTL(a.floating)),s=O(l),d=B(l),u=j(l)==="x",g=["left","top"].includes(s)?-1:1,m=h&&u?-1:1,p=typeof c=="function"?c(r):c;let{mainAxis:y,crossAxis:x,alignmentAxis:v}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return d&&typeof v=="number"&&(x=d==="end"?-1*v:v),u?{x:x*m,y:y*g}:{x:y*g,y:x*m}}(e,t);return{x:o+i.x,y:n+i.y,data:i}}}};function Mt(t){return t==="x"?"y":"x"}const Jt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:o,y:n,placement:i}=e,{mainAxis:r=!0,crossAxis:c=!1,limiter:l={fn:p=>{let{x:y,y:x}=p;return{x:y,y:x}}},...f}=t,a={x:o,y:n},h=await J(e,f),s=j(O(i)),d=Mt(s);let u=a[s],g=a[d];if(r){const p=s==="y"?"bottom":"right";u=rt(u+h[s==="y"?"top":"left"],u,u-h[p])}if(c){const p=d==="y"?"bottom":"right";g=rt(g+h[d==="y"?"top":"left"],g,g-h[p])}const m=l.fn({...e,[s]:u,[d]:g});return{...m,data:{x:m.x-o,y:m.y-n}}}}};function C(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function H(t){return C(t).getComputedStyle(t)}function Tt(t){return t instanceof C(t).Node}function z(t){return Tt(t)?(t.nodeName||"").toLowerCase():""}function F(t){return t instanceof C(t).HTMLElement}function D(t){return t instanceof C(t).Element}function yt(t){return typeof ShadowRoot>"u"?!1:t instanceof C(t).ShadowRoot||t instanceof ShadowRoot}function K(t){const{overflow:e,overflowX:o,overflowY:n,display:i}=H(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+o)&&!["inline","contents"].includes(i)}function zt(t){return["table","td","th"].includes(z(t))}function lt(t){const e=at(),o=H(t);return o.transform!=="none"||o.perspective!=="none"||!e&&!!o.backdropFilter&&o.backdropFilter!=="none"||!e&&!!o.filter&&o.filter!=="none"||["transform","perspective","filter"].some(n=>(o.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(o.contain||"").includes(n))}function at(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function nt(t){return["html","body","#document"].includes(z(t))}const xt=Math.min,G=Math.max,et=Math.round;function At(t){const e=H(t);let o=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=F(t),r=i?t.offsetWidth:o,c=i?t.offsetHeight:n,l=et(o)!==r||et(n)!==c;return l&&(o=r,n=c),{width:o,height:n,fallback:l}}function $t(t){return D(t)?t:t.contextElement}const Pt={x:1,y:1};function X(t){const e=$t(t);if(!F(e))return Pt;const o=e.getBoundingClientRect(),{width:n,height:i,fallback:r}=At(e);let c=(r?et(o.width):o.width)/n,l=(r?et(o.height):o.height)/i;return c&&Number.isFinite(c)||(c=1),l&&Number.isFinite(l)||(l=1),{x:c,y:l}}const wt={x:0,y:0};function Dt(t,e,o){var n,i;if(e===void 0&&(e=!0),!at())return wt;const r=t?C(t):window;return!o||e&&o!==r?wt:{x:((n=r.visualViewport)==null?void 0:n.offsetLeft)||0,y:((i=r.visualViewport)==null?void 0:i.offsetTop)||0}}function N(t,e,o,n){e===void 0&&(e=!1),o===void 0&&(o=!1);const i=t.getBoundingClientRect(),r=$t(t);let c=Pt;e&&(n?D(n)&&(c=X(n)):c=X(t));const l=Dt(r,o,n);let f=(i.left+l.x)/c.x,a=(i.top+l.y)/c.y,h=i.width/c.x,s=i.height/c.y;if(r){const d=C(r),u=n&&D(n)?C(n):n;let g=d.frameElement;for(;g&&n&&u!==d;){const m=X(g),p=g.getBoundingClientRect(),y=getComputedStyle(g);p.x+=(g.clientLeft+parseFloat(y.paddingLeft))*m.x,p.y+=(g.clientTop+parseFloat(y.paddingTop))*m.y,f*=m.x,a*=m.y,h*=m.x,s*=m.y,f+=p.x,a+=p.y,g=C(g).frameElement}}return Y({width:h,height:s,x:f,y:a})}function M(t){return((Tt(t)?t.ownerDocument:t.document)||window.document).documentElement}function ot(t){return D(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function kt(t){return N(M(t)).left+ot(t).scrollLeft}function _(t){if(z(t)==="html")return t;const e=t.assignedSlot||t.parentNode||yt(t)&&t.host||M(t);return yt(e)?e.host:e}function Ct(t){const e=_(t);return nt(e)?e.ownerDocument.body:F(e)&&K(e)?e:Ct(e)}function I(t,e){var o;e===void 0&&(e=[]);const n=Ct(t),i=n===((o=t.ownerDocument)==null?void 0:o.body),r=C(n);return i?e.concat(r,r.visualViewport||[],K(n)?n:[]):e.concat(n,I(n))}function vt(t,e,o){let n;if(e==="viewport")n=function(i,r){const c=C(i),l=M(i),f=c.visualViewport;let a=l.clientWidth,h=l.clientHeight,s=0,d=0;if(f){a=f.width,h=f.height;const u=at();(!u||u&&r==="fixed")&&(s=f.offsetLeft,d=f.offsetTop)}return{width:a,height:h,x:s,y:d}}(t,o);else if(e==="document")n=function(i){const r=M(i),c=ot(i),l=i.ownerDocument.body,f=G(r.scrollWidth,r.clientWidth,l.scrollWidth,l.clientWidth),a=G(r.scrollHeight,r.clientHeight,l.scrollHeight,l.clientHeight);let h=-c.scrollLeft+kt(i);const s=-c.scrollTop;return H(l).direction==="rtl"&&(h+=G(r.clientWidth,l.clientWidth)-f),{width:f,height:a,x:h,y:s}}(M(t));else if(D(e))n=function(i,r){const c=N(i,!0,r==="fixed"),l=c.top+i.clientTop,f=c.left+i.clientLeft,a=F(i)?X(i):{x:1,y:1};return{width:i.clientWidth*a.x,height:i.clientHeight*a.y,x:f*a.x,y:l*a.y}}(e,o);else{const i=Dt(t);n={...e,x:e.x-i.x,y:e.y-i.y}}return Y(n)}function St(t,e){const o=_(t);return!(o===e||!D(o)||nt(o))&&(H(o).position==="fixed"||St(o,e))}function bt(t,e){return F(t)&&H(t).position!=="fixed"?e?e(t):t.offsetParent:null}function Rt(t,e){const o=C(t);if(!F(t))return o;let n=bt(t,e);for(;n&&zt(n)&&H(n).position==="static";)n=bt(n,e);return n&&(z(n)==="html"||z(n)==="body"&&H(n).position==="static"&&!lt(n))?o:n||function(i){let r=_(i);for(;F(r)&&!nt(r);){if(lt(r))return r;r=_(r)}return null}(t)||o}function Nt(t,e,o){const n=F(e),i=M(e),r=o==="fixed",c=N(t,!0,r,e);let l={scrollLeft:0,scrollTop:0};const f={x:0,y:0};if(n||!n&&!r)if((z(e)!=="body"||K(i))&&(l=ot(e)),F(e)){const a=N(e,!0,r,e);f.x=a.x+e.clientLeft,f.y=a.y+e.clientTop}else i&&(f.x=kt(i));return{x:c.left+l.scrollLeft-f.x,y:c.top+l.scrollTop-f.y,width:c.width,height:c.height}}const Xt={getClippingRect:function(t){let{element:e,boundary:o,rootBoundary:n,strategy:i}=t;const r=o==="clippingAncestors"?function(a,h){const s=h.get(a);if(s)return s;let d=I(a).filter(p=>D(p)&&z(p)!=="body"),u=null;const g=H(a).position==="fixed";let m=g?_(a):a;for(;D(m)&&!nt(m);){const p=H(m),y=lt(m);y||p.position!=="fixed"||(u=null),(g?!y&&!u:!y&&p.position==="static"&&u&&["absolute","fixed"].includes(u.position)||K(m)&&!y&&St(a,m))?d=d.filter(x=>x!==m):u=p,m=_(m)}return h.set(a,d),d}(e,this._c):[].concat(o),c=[...r,n],l=c[0],f=c.reduce((a,h)=>{const s=vt(e,h,i);return a.top=G(s.top,a.top),a.right=xt(s.right,a.right),a.bottom=xt(s.bottom,a.bottom),a.left=G(s.left,a.left),a},vt(e,l,i));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const i=F(o),r=M(o);if(o===r)return e;let c={scrollLeft:0,scrollTop:0},l={x:1,y:1};const f={x:0,y:0};if((i||!i&&n!=="fixed")&&((z(o)!=="body"||K(r))&&(c=ot(o)),F(o))){const a=N(o);l=X(o),f.x=a.x+o.clientLeft,f.y=a.y+o.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-c.scrollLeft*l.x+f.x,y:e.y*l.y-c.scrollTop*l.y+f.y}},isElement:D,getDimensions:function(t){return At(t)},getOffsetParent:Rt,getDocumentElement:M,getScale:X,async getElementRects(t){let{reference:e,floating:o,strategy:n}=t;const i=this.getOffsetParent||Rt,r=this.getDimensions;return{reference:Nt(e,await i(o),n),floating:{x:0,y:0,...await r(o)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>H(t).direction==="rtl"};function Kt(t,e,o,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:c=!0,animationFrame:l=!1}=n,f=i||r?[...D(t)?I(t):t.contextElement?I(t.contextElement):[],...I(e)]:[];f.forEach(d=>{const u=!D(d)&&d.toString().includes("V");!i||l&&!u||d.addEventListener("scroll",o,{passive:!0}),r&&d.addEventListener("resize",o)});let a,h=null;c&&(h=new ResizeObserver(()=>{o()}),D(t)&&!l&&h.observe(t),D(t)||!t.contextElement||l||h.observe(t.contextElement),h.observe(e));let s=l?N(t):null;return l&&function d(){const u=N(t);!s||u.x===s.x&&u.y===s.y&&u.width===s.width&&u.height===s.height||o(),s=u,a=requestAnimationFrame(d)}(),o(),()=>{var d;f.forEach(u=>{i&&u.removeEventListener("scroll",o),r&&u.removeEventListener("resize",o)}),(d=h)==null||d.disconnect(),h=null,l&&cancelAnimationFrame(a)}}const Qt=(t,e,o)=>{const n=new Map,i={platform:Xt,...o},r={...i.platform,_c:n};return Bt(t,e,{...i,platform:r})};export{It as D,Qt as M,qt as P,Gt as T,jt as b,Jt as k,Yt as u,_t as v,Kt as z};
