function B(t){return t.split("-")[1]}function at(t){return t==="y"?"height":"width"}function H(t){return t.split("-")[0]}function _(t){return["top","bottom"].includes(H(t))?"x":"y"}function mt(t,e,o){let{reference:n,floating:c}=t;const i=n.x+n.width/2-c.width/2,r=n.y+n.height/2-c.height/2,l=_(e),f=at(l),a=n[f]/2-c[f]/2,m=l==="x";let s;switch(H(e)){case"top":s={x:i,y:n.y-c.height};break;case"bottom":s={x:i,y:n.y+n.height};break;case"right":s={x:n.x+n.width,y:r};break;case"left":s={x:n.x-c.width,y:r};break;default:s={x:n.x,y:n.y}}switch(B(e)){case"start":s[l]-=a*(o&&m?-1:1);break;case"end":s[l]+=a*(o&&m?-1:1)}return s}const Bt=async(t,e,o)=>{const{placement:n="bottom",strategy:c="absolute",middleware:i=[],platform:r}=o,l=i.filter(Boolean),f=await(r.isRTL==null?void 0:r.isRTL(e));let a=await r.getElementRects({reference:t,floating:e,strategy:c}),{x:m,y:s}=mt(a,n,f),d=n,u={},x=0;for(let h=0;h<l.length;h++){const{name:p,fn:g}=l[h],{x:y,y:w,data:L,reset:b}=await g({x:m,y:s,initialPlacement:n,placement:d,strategy:c,middlewareData:u,rects:a,platform:r,elements:{reference:t,floating:e}});m=y!=null?y:m,s=w!=null?w:s,u={...u,[p]:{...u[p],...L}},b&&x<=50&&(x++,typeof b=="object"&&(b.placement&&(d=b.placement),b.rects&&(a=b.rects===!0?await r.getElementRects({reference:t,floating:e,strategy:c}):b.rects),{x:m,y:s}=mt(a,d,f)),h=-1)}return{x:m,y:s,placement:d,strategy:c,middlewareData:u}};function ft(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function X(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function J(t,e){var o;e===void 0&&(e={});const{x:n,y:c,platform:i,rects:r,elements:l,strategy:f}=t,{boundary:a="clippingAncestors",rootBoundary:m="viewport",elementContext:s="floating",altBoundary:d=!1,padding:u=0}=e,x=ft(u),h=l[d?s==="floating"?"reference":"floating":s],p=X(await i.getClippingRect({element:(o=await(i.isElement==null?void 0:i.isElement(h)))==null||o?h:h.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:a,rootBoundary:m,strategy:f})),g=s==="floating"?{...r.floating,x:n,y:c}:r.reference,y=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),w=await(i.isElement==null?void 0:i.isElement(y))&&await(i.getScale==null?void 0:i.getScale(y))||{x:1,y:1},L=X(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:g,offsetParent:y,strategy:f}):g);return{top:(p.top-L.top+x.top)/w.y,bottom:(L.bottom-p.bottom+x.bottom)/w.y,left:(p.left-L.left+x.left)/w.x,right:(L.right-p.right+x.right)/w.x}}const Z=Math.min,tt=Math.max;function lt(t,e,o){return tt(t,Z(e,o))}const Xt=t=>({name:"arrow",options:t,async fn(e){const{element:o,padding:n=0}=t||{},{x:c,y:i,placement:r,rects:l,platform:f,elements:a}=e;if(o==null)return{};const m=ft(n),s={x:c,y:i},d=_(r),u=at(d),x=await f.getDimensions(o),h=d==="y",p=h?"top":"left",g=h?"bottom":"right",y=h?"clientHeight":"clientWidth",w=l.reference[u]+l.reference[d]-s[d]-l.floating[u],L=s[d]-l.reference[d],b=await(f.getOffsetParent==null?void 0:f.getOffsetParent(o));let T=b?b[y]:0;T&&await(f.isElement==null?void 0:f.isElement(b))||(T=a.floating[y]||l.floating[u]);const P=w/2-L/2,$=m[p],O=T-x[u]-m[g],v=T/2-x[u]/2+P,R=lt($,v,O),A=B(r)!=null&&v!=R&&l.reference[u]/2-(v<$?m[p]:m[g])-x[u]/2<0;return{[d]:s[d]-(A?v<$?$-v:O-v:0),data:{[d]:R,centerOffset:v-R}}}}),Lt=["top","right","bottom","left"],ht=Lt.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]),Vt={left:"right",right:"left",bottom:"top",top:"bottom"};function et(t){return t.replace(/left|right|bottom|top/g,e=>Vt[e])}function Et(t,e,o){o===void 0&&(o=!1);const n=B(t),c=_(t),i=at(c);let r=c==="x"?n===(o?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(r=et(r)),{main:r,cross:et(r)}}const Wt={start:"end",end:"start"};function U(t){return t.replace(/start|end/g,e=>Wt[e])}const Yt=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var o,n,c;const{rects:i,middlewareData:r,placement:l,platform:f,elements:a}=e,{crossAxis:m=!1,alignment:s,allowedPlacements:d=ht,autoAlignment:u=!0,...x}=t,h=s!==void 0||d===ht?function(v,R,A){return(v?[...A.filter(E=>B(E)===v),...A.filter(E=>B(E)!==v)]:A.filter(E=>H(E)===E)).filter(E=>!v||B(E)===v||!!R&&U(E)!==E)}(s||null,u,d):d,p=await J(e,x),g=((o=r.autoPlacement)==null?void 0:o.index)||0,y=h[g];if(y==null)return{};const{main:w,cross:L}=Et(y,i,await(f.isRTL==null?void 0:f.isRTL(a.floating)));if(l!==y)return{reset:{placement:h[0]}};const b=[p[H(y)],p[w],p[L]],T=[...((n=r.autoPlacement)==null?void 0:n.overflows)||[],{placement:y,overflows:b}],P=h[g+1];if(P)return{data:{index:g+1,overflows:T},reset:{placement:P}};const $=T.map(v=>{const R=B(v.placement);return[v.placement,R&&m?v.overflows.slice(0,2).reduce((A,E)=>A+E,0):v.overflows[0],v.overflows]}).sort((v,R)=>v[1]-R[1]),O=((c=$.filter(v=>v[2].slice(0,B(v[0])?2:3).every(R=>R<=0))[0])==null?void 0:c[0])||$[0][0];return O!==l?{data:{index:g+1,overflows:T},reset:{placement:O}}:{}}}},_t=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var o;const{placement:n,middlewareData:c,rects:i,initialPlacement:r,platform:l,elements:f}=e,{mainAxis:a=!0,crossAxis:m=!0,fallbackPlacements:s,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:x=!0,...h}=t,p=H(n),g=H(r)===r,y=await(l.isRTL==null?void 0:l.isRTL(f.floating)),w=s||(g||!x?[et(r)]:function(R){const A=et(R);return[U(R),A,U(A)]}(r));s||u==="none"||w.push(...function(R,A,E,W){const V=B(R);let C=function(q,rt,Ht){const ut=["left","right"],dt=["right","left"],Ft=["top","bottom"],St=["bottom","top"];switch(q){case"top":case"bottom":return Ht?rt?dt:ut:rt?ut:dt;case"left":case"right":return rt?Ft:St;default:return[]}}(H(R),E==="start",W);return V&&(C=C.map(q=>q+"-"+V),A&&(C=C.concat(C.map(U)))),C}(r,x,u,y));const L=[r,...w],b=await J(e,h),T=[];let P=((o=c.flip)==null?void 0:o.overflows)||[];if(a&&T.push(b[p]),m){const{main:R,cross:A}=Et(n,i,y);T.push(b[R],b[A])}if(P=[...P,{placement:n,overflows:T}],!T.every(R=>R<=0)){var $,O;const R=((($=c.flip)==null?void 0:$.index)||0)+1,A=L[R];if(A)return{data:{index:R,overflows:P},reset:{placement:A}};let E=(O=P.filter(W=>W.overflows[0]<=0).sort((W,V)=>W.overflows[1]-V.overflows[1])[0])==null?void 0:O.placement;if(!E)switch(d){case"bestFit":{var v;const W=(v=P.map(V=>[V.placement,V.overflows.filter(C=>C>0).reduce((C,q)=>C+q,0)]).sort((V,C)=>V[1]-C[1])[0])==null?void 0:v[0];W&&(E=W);break}case"initialPlacement":E=r}if(n!==E)return{reset:{placement:E}}}return{}}}};function gt(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function pt(t){return Lt.some(e=>t[e]>=0)}const qt=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{strategy:o="referenceHidden",...n}=t,{rects:c}=e;switch(o){case"referenceHidden":{const i=gt(await J(e,{...n,elementContext:"reference"}),c.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:pt(i)}}}case"escaped":{const i=gt(await J(e,{...n,altBoundary:!0}),c.floating);return{data:{escapedOffsets:i,escaped:pt(i)}}}default:return{}}}}};function yt(t){const e=Z(...t.map(n=>n.left)),o=Z(...t.map(n=>n.top));return{x:e,y:o,width:tt(...t.map(n=>n.right))-e,height:tt(...t.map(n=>n.bottom))-o}}const Gt=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){const{placement:o,elements:n,rects:c,platform:i,strategy:r}=e,{padding:l=2,x:f,y:a}=t,m=Array.from(await(i.getClientRects==null?void 0:i.getClientRects(n.reference))||[]),s=function(h){const p=h.slice().sort((w,L)=>w.y-L.y),g=[];let y=null;for(let w=0;w<p.length;w++){const L=p[w];!y||L.y-y.y>y.height/2?g.push([L]):g[g.length-1].push(L),y=L}return g.map(w=>X(yt(w)))}(m),d=X(yt(m)),u=ft(l),x=await i.getElementRects({reference:{getBoundingClientRect:function(){if(s.length===2&&s[0].left>s[1].right&&f!=null&&a!=null)return s.find(h=>f>h.left-u.left&&f<h.right+u.right&&a>h.top-u.top&&a<h.bottom+u.bottom)||d;if(s.length>=2){if(_(o)==="x"){const b=s[0],T=s[s.length-1],P=H(o)==="top",$=b.top,O=T.bottom,v=P?b.left:T.left,R=P?b.right:T.right;return{top:$,bottom:O,left:v,right:R,width:R-v,height:O-$,x:v,y:$}}const h=H(o)==="left",p=tt(...s.map(b=>b.right)),g=Z(...s.map(b=>b.left)),y=s.filter(b=>h?b.left===g:b.right===p),w=y[0].top,L=y[y.length-1].bottom;return{top:w,bottom:L,left:g,right:p,width:p-g,height:L-w,x:g,y:w}}return d}},floating:n.floating,strategy:r});return c.reference.x!==x.reference.x||c.reference.y!==x.reference.y||c.reference.width!==x.reference.width||c.reference.height!==x.reference.height?{reset:{rects:x}}:{}}}},It=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:o,y:n}=e,c=await async function(i,r){const{placement:l,platform:f,elements:a}=i,m=await(f.isRTL==null?void 0:f.isRTL(a.floating)),s=H(l),d=B(l),u=_(l)==="x",x=["left","top"].includes(s)?-1:1,h=m&&u?-1:1,p=typeof r=="function"?r(i):r;let{mainAxis:g,crossAxis:y,alignmentAxis:w}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return d&&typeof w=="number"&&(y=d==="end"?-1*w:w),u?{x:y*h,y:g*x}:{x:g*x,y:y*h}}(e,t);return{x:o+c.x,y:n+c.y,data:c}}}};function Mt(t){return t==="x"?"y":"x"}const Jt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:o,y:n,placement:c}=e,{mainAxis:i=!0,crossAxis:r=!1,limiter:l={fn:p=>{let{x:g,y}=p;return{x:g,y}}},...f}=t,a={x:o,y:n},m=await J(e,f),s=_(H(c)),d=Mt(s);let u=a[s],x=a[d];if(i){const p=s==="y"?"bottom":"right";u=lt(u+m[s==="y"?"top":"left"],u,u-m[p])}if(r){const p=d==="y"?"bottom":"right";x=lt(x+m[d==="y"?"top":"left"],x,x-m[p])}const h=l.fn({...e,[s]:u,[d]:x});return{...h,data:{x:h.x-o,y:h.y-n}}}}};function D(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function F(t){return D(t).getComputedStyle(t)}function Tt(t){return t instanceof D(t).Node}function z(t){return Tt(t)?(t.nodeName||"").toLowerCase():""}let Q;function At(){if(Q)return Q;const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?(Q=t.brands.map(e=>e.brand+"/"+e.version).join(" "),Q):navigator.userAgent}function S(t){return t instanceof D(t).HTMLElement}function k(t){return t instanceof D(t).Element}function xt(t){return typeof ShadowRoot>"u"?!1:t instanceof D(t).ShadowRoot||t instanceof ShadowRoot}function K(t){const{overflow:e,overflowX:o,overflowY:n,display:c}=F(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+o)&&!["inline","contents"].includes(c)}function zt(t){return["table","td","th"].includes(z(t))}function ct(t){const e=/firefox/i.test(At()),o=F(t),n=o.backdropFilter||o.WebkitBackdropFilter;return o.transform!=="none"||o.perspective!=="none"||!!n&&n!=="none"||e&&o.willChange==="filter"||e&&!!o.filter&&o.filter!=="none"||["transform","perspective"].some(c=>o.willChange.includes(c))||["paint","layout","strict","content"].some(c=>{const i=o.contain;return i!=null&&i.includes(c)})}function st(){return/^((?!chrome|android).)*safari/i.test(At())}function ot(t){return["html","body","#document"].includes(z(t))}const wt=Math.min,G=Math.max,nt=Math.round;function $t(t){const e=F(t);let o=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const c=S(t),i=c?t.offsetWidth:o,r=c?t.offsetHeight:n,l=nt(o)!==i||nt(n)!==r;return l&&(o=i,n=r),{width:o,height:n,fallback:l}}function Pt(t){return k(t)?t:t.contextElement}const Dt={x:1,y:1};function j(t){const e=Pt(t);if(!S(e))return Dt;const o=e.getBoundingClientRect(),{width:n,height:c,fallback:i}=$t(e);let r=(i?nt(o.width):o.width)/n,l=(i?nt(o.height):o.height)/c;return r&&Number.isFinite(r)||(r=1),l&&Number.isFinite(l)||(l=1),{x:r,y:l}}function N(t,e,o,n){var c,i;e===void 0&&(e=!1),o===void 0&&(o=!1);const r=t.getBoundingClientRect(),l=Pt(t);let f=Dt;e&&(n?k(n)&&(f=j(n)):f=j(t));const a=l?D(l):window,m=st()&&o;let s=(r.left+(m&&((c=a.visualViewport)==null?void 0:c.offsetLeft)||0))/f.x,d=(r.top+(m&&((i=a.visualViewport)==null?void 0:i.offsetTop)||0))/f.y,u=r.width/f.x,x=r.height/f.y;if(l){const h=D(l),p=n&&k(n)?D(n):n;let g=h.frameElement;for(;g&&n&&p!==h;){const y=j(g),w=g.getBoundingClientRect(),L=getComputedStyle(g);w.x+=(g.clientLeft+parseFloat(L.paddingLeft))*y.x,w.y+=(g.clientTop+parseFloat(L.paddingTop))*y.y,s*=y.x,d*=y.y,u*=y.x,x*=y.y,s+=w.x,d+=w.y,g=D(g).frameElement}}return X({width:u,height:x,x:s,y:d})}function M(t){return((Tt(t)?t.ownerDocument:t.document)||window.document).documentElement}function it(t){return k(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function kt(t){return N(M(t)).left+it(t).scrollLeft}function Y(t){if(z(t)==="html")return t;const e=t.assignedSlot||t.parentNode||xt(t)&&t.host||M(t);return xt(e)?e.host:e}function Ct(t){const e=Y(t);return ot(e)?e.ownerDocument.body:S(e)&&K(e)?e:Ct(e)}function I(t,e){var o;e===void 0&&(e=[]);const n=Ct(t),c=n===((o=t.ownerDocument)==null?void 0:o.body),i=D(n);return c?e.concat(i,i.visualViewport||[],K(n)?n:[]):e.concat(n,I(n))}function vt(t,e,o){let n;if(e==="viewport")n=function(r,l){const f=D(r),a=M(r),m=f.visualViewport;let s=a.clientWidth,d=a.clientHeight,u=0,x=0;if(m){s=m.width,d=m.height;const h=st();(!h||h&&l==="fixed")&&(u=m.offsetLeft,x=m.offsetTop)}return{width:s,height:d,x:u,y:x}}(t,o);else if(e==="document")n=function(r){const l=M(r),f=it(r),a=r.ownerDocument.body,m=G(l.scrollWidth,l.clientWidth,a.scrollWidth,a.clientWidth),s=G(l.scrollHeight,l.clientHeight,a.scrollHeight,a.clientHeight);let d=-f.scrollLeft+kt(r);const u=-f.scrollTop;return F(a).direction==="rtl"&&(d+=G(l.clientWidth,a.clientWidth)-m),{width:m,height:s,x:d,y:u}}(M(t));else if(k(e))n=function(r,l){const f=N(r,!0,l==="fixed"),a=f.top+r.clientTop,m=f.left+r.clientLeft,s=S(r)?j(r):{x:1,y:1};return{width:r.clientWidth*s.x,height:r.clientHeight*s.y,x:m*s.x,y:a*s.y}}(e,o);else{const r={...e};if(st()){var c,i;const l=D(t);r.x-=((c=l.visualViewport)==null?void 0:c.offsetLeft)||0,r.y-=((i=l.visualViewport)==null?void 0:i.offsetTop)||0}n=r}return X(n)}function Ot(t,e){const o=Y(t);return!(o===e||!k(o)||ot(o))&&(F(o).position==="fixed"||Ot(o,e))}function bt(t,e){return S(t)&&F(t).position!=="fixed"?e?e(t):t.offsetParent:null}function Rt(t,e){const o=D(t);if(!S(t))return o;let n=bt(t,e);for(;n&&zt(n)&&F(n).position==="static";)n=bt(n,e);return n&&(z(n)==="html"||z(n)==="body"&&F(n).position==="static"&&!ct(n))?o:n||function(c){let i=Y(c);for(;S(i)&&!ot(i);){if(ct(i))return i;i=Y(i)}return null}(t)||o}function Nt(t,e,o){const n=S(e),c=M(e),i=N(t,!0,o==="fixed",e);let r={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(n||!n&&o!=="fixed")if((z(e)!=="body"||K(c))&&(r=it(e)),S(e)){const f=N(e,!0);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else c&&(l.x=kt(c));return{x:i.left+r.scrollLeft-l.x,y:i.top+r.scrollTop-l.y,width:i.width,height:i.height}}const jt={getClippingRect:function(t){let{element:e,boundary:o,rootBoundary:n,strategy:c}=t;const i=o==="clippingAncestors"?function(a,m){const s=m.get(a);if(s)return s;let d=I(a).filter(p=>k(p)&&z(p)!=="body"),u=null;const x=F(a).position==="fixed";let h=x?Y(a):a;for(;k(h)&&!ot(h);){const p=F(h),g=ct(h);g||p.position!=="fixed"||(u=null),(x?!g&&!u:!g&&p.position==="static"&&u&&["absolute","fixed"].includes(u.position)||K(h)&&!g&&Ot(a,h))?d=d.filter(y=>y!==h):u=p,h=Y(h)}return m.set(a,d),d}(e,this._c):[].concat(o),r=[...i,n],l=r[0],f=r.reduce((a,m)=>{const s=vt(e,m,c);return a.top=G(s.top,a.top),a.right=wt(s.right,a.right),a.bottom=wt(s.bottom,a.bottom),a.left=G(s.left,a.left),a},vt(e,l,c));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:o,strategy:n}=t;const c=S(o),i=M(o);if(o===i)return e;let r={scrollLeft:0,scrollTop:0},l={x:1,y:1};const f={x:0,y:0};if((c||!c&&n!=="fixed")&&((z(o)!=="body"||K(i))&&(r=it(o)),S(o))){const a=N(o);l=j(o),f.x=a.x+o.clientLeft,f.y=a.y+o.clientTop}return{width:e.width*l.x,height:e.height*l.y,x:e.x*l.x-r.scrollLeft*l.x+f.x,y:e.y*l.y-r.scrollTop*l.y+f.y}},isElement:k,getDimensions:function(t){return $t(t)},getOffsetParent:Rt,getDocumentElement:M,getScale:j,async getElementRects(t){let{reference:e,floating:o,strategy:n}=t;const c=this.getOffsetParent||Rt,i=this.getDimensions;return{reference:Nt(e,await c(o),n),floating:{x:0,y:0,...await i(o)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>F(t).direction==="rtl"};function Kt(t,e,o,n){n===void 0&&(n={});const{ancestorScroll:c=!0,ancestorResize:i=!0,elementResize:r=!0,animationFrame:l=!1}=n,f=c||i?[...k(t)?I(t):t.contextElement?I(t.contextElement):[],...I(e)]:[];f.forEach(d=>{const u=!k(d)&&d.toString().includes("V");!c||l&&!u||d.addEventListener("scroll",o,{passive:!0}),i&&d.addEventListener("resize",o)});let a,m=null;r&&(m=new ResizeObserver(()=>{o()}),k(t)&&!l&&m.observe(t),k(t)||!t.contextElement||l||m.observe(t.contextElement),m.observe(e));let s=l?N(t):null;return l&&function d(){const u=N(t);!s||u.x===s.x&&u.y===s.y&&u.width===s.width&&u.height===s.height||o(),s=u,a=requestAnimationFrame(d)}(),o(),()=>{var d;f.forEach(u=>{c&&u.removeEventListener("scroll",o),i&&u.removeEventListener("resize",o)}),(d=m)==null||d.disconnect(),m=null,l&&cancelAnimationFrame(a)}}const Qt=(t,e,o)=>{const n=new Map,c={platform:jt,...o},i={...c.platform,_c:n};return Bt(t,e,{...c,platform:i})};export{It as D,qt as P,Gt as T,Jt as a,_t as b,Qt as k,Xt as u,Yt as v,Kt as z};
