import{p as oe}from"./index.f82077be.js";import{e as U,h as ne,i as q,t as B}from"./index.bb7607a8.js";import{x as Z,g as m,h as E,u as b,D as ae,f as L,k,r as y,o as j,c as V,m as p,a as v,w as C,y as T,z as _,i as $,a7 as se,L as re,A as J,_ as W,C as K,l as S,N as ie,j as le,V as ue,d as z,E as H,T as de,n as ce}from"../app.b96ee9a3.js";import{I as fe,a as pe}from"./16.c0e25d73.js";import{u as ve}from"./utils-6ba05f5b.7e2434e1.js";import{I as me}from"./16.46061f21.js";import{p as ge}from"./Button.6c0581b2.js";import{p as he}from"./Divider.d1f25ec9.js";import{p as _e}from"./Select.a915267f.js";import{t as ye,m as Pe,l as we,h as $e,o as x,k as be,j as De}from"./index.8e95e3ae.js";import{f as Ee}from"./focus.419a5f01.js";import{u as M}from"./index.be437476.js";import{d as Se}from"./debounce.09764d19.js";import{r as Ce}from"./isObjectLike.46b91259.js";import{a as Ne}from"./toInteger.1f8b77ad.js";import{t as Oe}from"./toNumber.685f5789.js";import{t as X}from"./toString.401226e4.js";import{u as Ie}from"./use-loading.adbdd23f.js";var Te=Ce.isFinite,Le=Math.min;function ke(e){var a=Math[e];return function(o,n){if(o=Oe(o),n=n==null?0:Le(Ne(n),292),n&&Te(o)){var t=(X(o)+"e").split("e"),s=a(t[0]+"e"+(+t[1]+n));return t=(X(s)+"e").split("e"),+(t[0]+"e"+(+t[1]-n))}return a(o)}}var je=ke("round");const Ve=je,Y=Symbol("PdfViewer");function Q(){return Z(Y,()=>{const e=m(1),a=m(1),o=m(0);return{page:e,scale:a,totalPage:o}},!0)}function Fe(e,a={}){const o=m(!1),n=E(()=>b(a.offsetTop)??0),t=E(()=>{var c;return(c=b(e))==null?void 0:c.parentElement}),{top:s,height:r}=U(t),{top:u,width:i,left:l}=U(e);return ae(c=>{o.value&&e.value&&(s.value-n.value>=0?(e.value.style.setProperty("height",`${window.innerHeight-u.value}px`),e.value.style.setProperty("width","100%")):(t.value.style.setProperty("min-height",`${r.value}px`),e.value.style.setProperty("position","fixed"),e.value.style.setProperty("top",`${n.value}px`),e.value.style.setProperty("left",`${l.value}px`),e.value.style.setProperty("width",`${i.value}px`),e.value.style.setProperty("height",`${window.innerHeight-n.value}px`)),c(()=>{t.value.style.removeProperty("min-height"),e.value.style.removeProperty("position"),e.value.style.removeProperty("top"),e.value.style.removeProperty("left"),e.value.style.removeProperty("width"),e.value.style.removeProperty("height")}))}),o}var ze=ve,ee=ze.createSVGComponent(ee,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",width:16,height:16},[{elem:"path",attrs:{d:"M8 5L13 10 12.3 10.7 8 6.4 3.7 10.7 3 10z"}}]),Be=ee;const Me=Be,Re=L({components:{IconZoomIn:fe,IconZoomOut:pe,IconPrev:Me,IconNext:me,pButton:ge,pDivider:he,pSelect:_e},setup(){const{page:e,scale:a,totalPage:o}=Q(),n=E(()=>Array.from({length:o.value}).map((i,l)=>({text:`${l+1}`,value:l+1})));function t(){a.value=Math.round(a.value/.1)*.1+.1}function s(){a.value=Math.round(a.value/.1)*.1-.1}function r(){e.value++}function u(){e.value--}return{page:e,pages:n,scale:a,totalPage:o,zoomIn:t,zoomOut:s,next:r,prev:u}}});const Ae={"data-testid":"pdf-navigation",class:"pdf__navigation"},He={class:"pdf__navigation-container"},We={class:"pdf__navigation-scale"},Ze={"data-testid":"pdf-total",class:"flex-shrink-0"};function Je(e,a,o,n,t,s){const r=y("IconZoomOut"),u=y("p-button"),i=y("IconZoomIn"),l=y("p-divider"),c=y("p-select"),g=y("IconPrev"),h=y("IconNext");return j(),V("div",Ae,[p("div",He,[v(u,{"data-testid":"pdf-zoom-out",variant:"ghost",size:"xs",icon:"",onClick:e.zoomOut},{default:C(()=>[v(r)]),_:1},8,["onClick"]),p("span",We,T((e.scale*100).toFixed(0))+"% ",1),v(u,{"data-testid":"pdf-zoom-in",variant:"ghost",size:"xs",icon:"",onClick:e.zoomIn},{default:C(()=>[v(i)]),_:1},8,["onClick"]),v(l,{vertical:""}),v(c,{modelValue:e.page,"onUpdate:modelValue":a[0]||(a[0]=P=>e.page=P),options:e.pages,size:"xs"},null,8,["modelValue","options"]),p("span",Ze,"of "+T(e.totalPage),1),v(u,{"data-testid":"pdf-prev",variant:"ghost",size:"xs",icon:"",onClick:e.prev},{default:C(()=>[v(g)]),_:1},8,["onClick"]),v(u,{"data-testid":"pdf-next",variant:"ghost",size:"xs",icon:"",onClick:e.next},{default:C(()=>[v(h)]),_:1},8,["onClick"])])])}const Ge=k(Re,[["render",Je]]),Ue="/design-system/assets/pdf-loading.4499014e.svg",xe=L({setup(){return{PDF_LOADING_IMG:Ue}}});const Xe={"data-testid":"pdf-loading",class:"pdf__loading"},qe=["src"];function Ke(e,a,o,n,t,s){return j(),V("div",Xe,[p("img",{src:e.PDF_LOADING_IMG,width:"793",height:"1122"},null,8,qe)])}const Ye=k(xe,[["render",Ke]]),Qe=L({props:{url:{type:String,default:""},pdfJs:{type:Object,default:()=>({})},error:{type:Object,default:()=>({})}},setup(){return{}}});const et={"data-testid":"pdf-error",class:"pdf__error"},tt=p("h3",{class:"text-danger"}," Failed to load PDF ",-1),ot={class:"mt-7"},nt=p("dt",null,"URL:",-1),at={class:"truncate"},st=["href"],rt=p("dt",null," Reason: ",-1),it=p("dt",null," PDFJS Version: ",-1);function lt(e,a,o,n,t,s){return j(),V("div",et,[tt,p("dl",ot,[nt,p("dd",at,[p("a",{href:e.url,target:"_blank"},[p("code",null,T(e.url),1)],8,st)]),rt,p("dd",null,[p("code",null,T(e.error.message),1)]),it,p("dd",null,[p("code",null,T(e.pdfJs.version),1)])])])}const ut=k(Qe,[["render",lt]]),dt=["mousemove","mousedown","touchstart","keydown","scroll"];function ct(e,a=5e3){const o=m(!1);let n;function t(){o.value=!1,n&&clearTimeout(n),n=setTimeout(()=>{o.value=!0},a)}return ne(e,dt,t,{passive:!0}),o}function ft(e,a=document.body,o=!1){const n=_();function t(){var s,r;n.value=o?(s=b(a))==null?void 0:s.querySelectorAll(b(e)):(r=b(a))==null?void 0:r.querySelector(b(e))}return $(()=>b(e),()=>{t()}),q(a,s=>{s.some(r=>r.type==="childList")&&t()},{childList:!0,subtree:!0}),ye(()=>{t()}),n}const G=Symbol("PDFObjects"),Jt=Symbol("PDFObjects");function pt(e){const a=E(()=>Ve(e.width/e.height,2)),o=m(e.minWidth??e.width*.5),n=m(e.maxWidth??e.width*2),t=m(e.minHeight??e.height*.5),s=m(e.maxHeight??e.height*2),r=M(e.width,o,n),u=M(e.height,t,s);return $(()=>e.minWidth,i=>{Number.isFinite(i)&&(o.value=i)}),$(()=>e.minHeight,i=>{Number.isFinite(i)&&(t.value=i)}),$(()=>e.maxWidth,i=>{Number.isFinite(i)&&(n.value=i)}),$(()=>e.maxHeight,i=>{Number.isFinite(i)&&(s.value=i)}),{ratio:a,width:r,height:u,minWidth:o,maxWidth:n,minHeight:t,maxHeight:s}}function Gt(e){const{objects:a,page:o}=Z(G),n=m(e.page??o.value),t=m(e.x),s=m(e.y),r=Symbol("PDFObject"),{width:u,height:i,minWidth:l,maxWidth:c,minHeight:g,maxHeight:h,ratio:P}=pt(e);return a.set(r,se({id:r,page:n,x:t,y:s,width:u,height:i})),Pe(()=>{Number.isFinite(n.value)||$e(o).toBeTruthy().then(()=>{n.value=o.value})}),we(()=>{a.delete(r)}),{id:r,x:t,y:s,page:n,width:u,height:i,minWidth:l,minHeight:g,maxWidth:c,maxHeight:h,ratio:P}}function Ut(e){const{root:a}=Z(G),o=E(()=>`.page[data-page-number="${b(e)}"]`);return ft(o,a)}const xt=Se(Ee,100),vt=Symbol("DropzoneContext");function mt(e,a){const o=_(!0),n=_(),t=m(),s=m();async function r(){if(u(),e.value){const{default:i}=await W(()=>import("./interact.min.b6164fcc.js").then(l=>l.i),["assets/chunks/interact.min.b6164fcc.js","assets/app.b96ee9a3.js"]);n.value=i(a.value,{context:e.value}).dropzone({accept:".pdf-object",overlap:.95,enabled:o.value,checker(l,c,g,h,P,N,D){return g&&(e.value.contains(D)||D.classList.contains("pdf-object--external"))},ondragenter(l){s.value=l.target,l.target.classList.add("hover")},ondragleave(l){l.target.classList.remove("hover")},ondrop(l){s.value=l.target,t.value=l.target,l.target.classList.remove("hover")}})}}function u(){n.value&&n.value.unset()}return q(e,i=>{i.some(c=>c.type==="childList"&&c.target.matches(a.value))&&r()},{subtree:!0,childList:!0}),re(()=>{u()}),J(vt,{dropzone:t,hoverzone:s}),o}const gt=L({props:{dropTarget:{type:String,default:".pdfViewer > .page"}},setup(e){const a=new Map,o=B("root"),n=Q(),t=K(e,"dropTarget");return J(G,{...n,objects:a,root:o}),mt(o,t),{}}}),ht={ref:"root","data-testid":"pdf-objects"};function _t(e,a,o,n,t,s){return j(),V("div",ht,[S(e.$slots,"default")],512)}const yt=k(gt,[["render",_t]]);function Pt(e,a){const o=_(),n=_(),t=_(),s=_(),r=_(),u=_(),i=E(()=>{var d;return((d=o.value)==null?void 0:d.numPages)??0}),l=M(1,.1,2),c=M(1,1,i),g=Ie(),h=_(!1),P=_(),N=x(),D=x();async function R(d,f){g.value=!0,P.value=void 0;try{u.value=await W(()=>import("./pdf.3c1b6e4a.js").then(w=>w.p),["assets/chunks/pdf.3c1b6e4a.js","assets/app.b96ee9a3.js","assets/chunks/vite-browser-external_commonjs-proxy.0c386400.js"]),typeof window<"u"&&"Worker"in window&&(u.value.GlobalWorkerOptions.workerSrc=`https://cdn.jsdelivr.net/npm/pdfjs-dist@${u.value.version}/build/pdf.worker.min.js`),await O(),d&&(s.value=u.value.getDocument({url:d,password:f,cMapUrl:`https://cdn.jsdelivr.net/npm/pdfjs-dist@${u.value.version}/cmaps/`,cMapPacked:!0,disableStream:!1}),o.value=await s.value.promise,t.value.setDocument(o.value),r.value.setDocument(o.value),N.trigger(o.value))}catch(w){w instanceof Error&&(P.value=w,D.trigger(w))}finally{g.value=!1}}async function O(){var d,f;s.value&&!s.value.destroyed&&(await s.value.destroy(),o.value=void 0,s.value=void 0,(d=t.value)==null||d.setDocument(null),(f=r.value)==null||f.setDocument(null))}async function A(){if(typeof navigator<"u"&&e.value&&a.value){const{NullL10n:d,PDFLinkService:f,PDFViewer:w,EventBus:te}=await W(()=>import("./pdf_viewer.a4ad64a5.js").then(I=>I.p),["assets/chunks/pdf_viewer.a4ad64a5.js","assets/app.b96ee9a3.js","assets/chunks/pdf.3c1b6e4a.js","assets/chunks/vite-browser-external_commonjs-proxy.0c386400.js"]),F=new te;F.on("pagesinit",()=>{t.value.currentScaleValue="page-width",t.value.currentPageNumber=c.value,h.value=!0}),F.on("pagechanging",I=>{c.value=I.pageNumber}),F.on("scalechanging",I=>{l.value=I.scale}),n.value=F,r.value=new f({eventBus:n.value}),t.value=new w({container:e.value,viewer:a.value,eventBus:n.value,linkService:r.value,l10n:d,useOnlyCssZoom:!1,removePageBorders:!0}),r.value.setViewer(t.value)}}return $([e,a],async([d,f])=>{t.value?d&&f&&(t.value.container=d,t.value.viewer=f,o.value&&t.value.setDocument(o.value),t.value.update()):await A()}),$(c,d=>{t.value&&d!==t.value.currentPageNumber&&(t.value.currentPageNumber=d)}),$(l,d=>{t.value&&d!==t.value.currentScale&&(t.value.currentScale=d)}),ie(async()=>{var d;(d=t.value)==null||d.cleanup(),await O()}),{page:c,scale:l,totalPage:i,loading:g,error:P,ready:h,openDoc:R,closeDoc:O,pdfDoc:o,pdfEventBus:n,pdfViewer:t,pdfLoadingTask:s,pdfLinkService:r,pdfJS:u,onLoaded:N.on,onError:D.on}}const wt=L({directives:{pAspectRatio:oe},components:{PdfObjects:yt,PdfNavigation:Ge,PdfLoading:Ye,PdfError:ut},props:{src:{type:String,default:""},password:{type:String,default:void 0},layout:{type:String,default:"fixed"},ratio:{type:[Number,String],default:210/297},offsetTop:{type:[Number,String],default:0}},emits:["loaded","error","error-password"],setup(e,{emit:a}){const o=B("root"),n=B("container"),t=B("viewer"),s=ct(n),r=be(K(e,"offsetTop"),{nanToZero:!0}),u=Fe(o,{offsetTop:r}),i=E(()=>{const f=[];return e.layout&&f.push(`pdf-viewer--layout-${e.layout}`),f}),{page:l,scale:c,totalPage:g,openDoc:h,closeDoc:P,pdfDoc:N,pdfJS:D,loading:R,error:O,onLoaded:A,onError:d}=Pt(n,t);return De(()=>[e.src,e.password],([f,w])=>{h(f,w)},{debounce:500}),$(()=>e.layout,f=>{u.value=f==="fit"},{immediate:!0}),le(async()=>{e.src&&h(e.src,e.password)}),A(f=>{a("loaded",f)}),d(f=>{f.name==="PasswordException"?a("error-password",f):a("error",f)}),J(Y,{page:l,scale:c,totalPage:g}),{classNames:i,page:l,scale:c,totalPage:g,openDoc:h,closeDoc:P,pdfDoc:N,pdfJS:D,idle:s,loading:R,error:O}}});const $t={class:"pdf__header"},bt={ref:"container",class:"pdf__container pdfContainer"},Dt={ref:"viewer",class:"pdf__viewer pdfViewer"},Et={class:"pdf__footer"};function St(e,a,o,n,t,s){const r=y("PdfLoading"),u=y("PdfError"),i=y("PdfNavigation"),l=y("PdfObjects"),c=ue("p-aspect-ratio");return z((j(),V("div",{ref:"root","data-testid":"pdf-viewer",class:ce(["pdf",e.classNames])},[p("div",$t,[S(e.$slots,"header",{page:e.page,scale:e.scale,totalPage:e.totalPage,doc:e.pdfDoc})]),v(l,{class:"pdf__wrapper"},{default:C(()=>[p("div",bt,[z(v(r,null,null,512),[[H,e.loading||!e.src]]),z(v(u,{url:e.src,"pdf-js":e.pdfJS,error:e.error},null,8,["url","pdf-js","error"]),[[H,!e.loading&&e.error]]),p("div",Dt,null,512),S(e.$slots,"default",{page:e.page,scale:e.scale,totalPage:e.totalPage,doc:e.pdfDoc})],512),S(e.$slots,"container",{page:e.page,scale:e.scale,totalPage:e.totalPage,doc:e.pdfDoc}),v(de,{name:"slide-up"},{default:C(()=>[z(v(i,null,null,512),[[H,!e.idle]])]),_:1}),S(e.$slots,"body",{page:e.page,scale:e.scale,totalPage:e.totalPage,doc:e.pdfDoc})]),_:3}),p("div",Et,[S(e.$slots,"footer",{page:e.page,scale:e.scale,totalPage:e.totalPage,doc:e.pdfDoc})])],2)),[[c,e.layout==="fixed"?e.ratio:16/9]])}const Xt=k(wt,[["render",St]]),qt="/design-system/assets/Calibrator-v3.e869f66c.pdf";export{vt as D,qt as F,Jt as P,Ut as a,G as b,xt as f,Xt as p,Gt as u};
